\documentclass{bioinfo}
\copyrightyear{2012}
\pubyear{2012}

\begin{document}
\firstpage{1}

\title[idock 1.5]{idock 1.5: Improving Docking Speed over AutoDock Vina}
\author[Hongjian Li \textit{et~al}]{Hongjian Li\footnote{to whom correspondence should be addressed}, Kwong-Sak Leung and Man-Hon Wong}
\address{Department of Computer Science and Engineering, Chinese University of Hong Kong, Shatin, New Territories, Hong Kong, China}

\history{Received on XXXXX; revised on XXXXX; accepted on XXXXX}

\editor{Associate Editor: XXXXXXX}

\maketitle

\begin{abstract}
\section{Summary:}
In a previous study, we reported idock 1.0, a multithreaded virtual screening tool for flexible ligand docking. In this study, we report idock 1.5, further improving docking speed and accuracy, inventing new functionalities, and fixing bugs. To better evaluate and compare idock 1.5 and the state-of-the-art AutoDock Vina 1.1.2, we carried out a redocking benchmark on PDBbind v2011 and CSAR NRC HiQ Set 24Sept2010, and a virtual screening benchmark on 12 receptors and 3000 ligands. Results showed that under various circumstances idock 1.5 displayed comparable success rates but outperformed AutoDock Vina in terms of docking speed by at least 8.69 times and at most 37.51 times.

\section{Availability:}
idock is free and open source under Apache License 2.0. Its C++ source code, precompiled executables for 32-bit and 64-bit Linux, Windows, Mac OS X, FreeBSD and Solaris, 12 docking examples, and a doxygen file for generating API documentations are available at https://github.com/HongjianLi/idock.

\section{Contact:} \href{hjli@cse.cuhk.edu.hk}{hjli@cse.cuhk.edu.hk}
\end{abstract}

\section{Introduction}

Protein-ligand docking predicts the preferred conformation and binding affinity of a small ligand when it is non-covalently bound to a specific binding site of a macro protein. Inspired by AutoDock Vina \citep{595}, we developed idock 1.0 \citep{1153}, a multithreaded virtual screening tool for flexible ligand docking. idock inherits from AutoDock Vina the accurate scoring function and the efficient optimization algorithm, and meanwhile introduces a fruitful of innovations, such as receptor and grid map caching for large-scale virtual screening, revised numerical model for much faster approximation, capability of automatic detection and deactivation of inactive torsions, utilization of our novel thread pool to parallelize grid map creation and reuse threads, utilization of modern C++11 features like right-value references to avoid frequent memory reallocation, and accelerated parsers for both receptor and ligand. When benchmarked on docking 10,928 drug-like ligands against HIV reverse transcriptase, idock 1.0 achieved a speedup of 3.3 in terms of CPU time and a speedup of 7.5 in terms of elapsed time on average compared to AutoDock Vina.

Despite the amazing speedup, idock 1.0 required about 10 hours on average to dock 10,928 drug-like ligands, not to mention massive docking of millions of ligands. Faster implementations are highly desired. Here we report idock 1.5, further improving docking speed and accuracy, inventing new functionalities, and fixing bugs.

\begin{methods}
\section{Methods}

Computationally speaking, idock 1.5 better supports right-value references and move semantics in C++11 to boost performance. It implements our novel thread pool in order to reuse threads and maintain a high CPU utilization throughout the entire screening procedure. The thread pool parallelizes the precalculation of scoring function, the creation of grid maps, and the execution of Monte Carlo tasks. idock 1.5 implements our own lightweight thread-safe progress bar, reporting progress every 10\% Monte Carlo tasks per ligand in a neat manner. It provides precompiled executables for 5 mainstream operating systems and 12 docking examples for instance use.

Functionally speaking, idock 1.5 supports reading and writing ligands in gzip/bzip2 format, resulting in a file footprint as low as just one eighth of the raw size. It supports as many as 29 chemical elements including rare ones like As (arsenic) and Sr (strontium). idock 1.5 enables automatic recovery, i.e. in case the process gets killed accidentally and restarted some time later, it not only resumes docking from the previous stopping point, but also detects and reports possible file content errors. It outputs to docked PDBQT files verbose information including the number of hydrogen bonds possibly formed and per-atom inter-ligand free energy, facilitating protein-ligand interaction hotspot determination and subsequent analysis.

\end{methods}

\section{Benchmark of Redocking}

Redocking refers to randomizing the crystal ligand conformation in a protein-ligand complex and trying to dock the randomized conformation back to its crystal conformation as close as possible. We used two datasets of protein-ligand complexes for benchmark. The refined set of PDBbind v2011 \citep{530} and the two sets of CSAR NRC HiQ Set 24Sept2010 \citep{857} comprise 2,455 and 343 protein-ligand complexes respectively. idock x86\_64 v1.5 and AutoDock Vina x86 v1.1.2 were evaluated on desktop computers with Intel Core i5 2400 CPU @ 3.10GHz and 4GB DDR3 RAM under Mac OS X 10.7.4 Build 11E53. Arguments to both programs were left as default. By default, both programs output 9 conformations per ligand.

Table \ref{tab:SuccessRate} shows the redocking success rates of idock and AutoDock Vina under various conditions regarding the RMSD (Root Mean Square Deviation) values between the crystal and docked conformations. RMSD1 refers to the RMSD value between the crystal conformation and the first docked conformation with the highest predicted binding affinity, while RMSDm refers to the RMSD value between the crystal conformation and the closest docked conformation with the lowest RMSD value. The condition RMSD1 = RMSDm therefore tests for how many percent the docked conformation with the highest predicted binding affinity actually turns out to be the closest one among the 9 predicted conformations. It can be seen that the success rates of idock were comparable to, albeit slightly lower than, AutoDock Vina. Using a RMSD value of 2.0 \AA, a publicly accepted positive control for correct bound structure prediction, both programs managed to predict a conformation close enough to the crystal conformation as the first conformation for over half of the cases on both datasets.

\begin{table}
\processtable{Success rates of idock and AutoDock Vina under various conditions on the refined set of PDBbind v2011 and the two sets of CSAR NRC HiQ Set 24Sept2010.\label{tab:SuccessRate}}
{\begin{tabular}{crrrr}
\toprule
& \multicolumn{2}{c}{PDBbind v2011} & \multicolumn{2}{c}{CSAR NRC HiQ}\\
Condition & idock & Vina & idock & Vina\\
\midrule
RMSD1 = RMSDm           & 47\% & 54\% & 57\% & 71\%\\
RMSD1 \textless 0.5 \AA & 11\% & 12\% & 21\% & 21\%\\
RMSD1 \textless 1.0 \AA & 29\% & 31\% & 40\% & 47\%\\
RMSD1 \textless 1.5 \AA & 45\% & 47\% & 61\% & 67\%\\
RMSD1 \textless 2.0 \AA & 53\% & 56\% & 68\% & 73\%\\
RMSDm \textless 0.5 \AA & 14\% & 15\% & 24\% & 26\%\\
RMSDm \textless 1.0 \AA & 39\% & 40\% & 54\% & 55\%\\
RMSDm \textless 1.5 \AA & 64\% & 65\% & 78\% & 84\%\\
RMSDm \textless 2.0 \AA & 74\% & 78\% & 86\% & 92\%\\
\botrule
\end{tabular}}{idock 1.5 displayed success rates comparable to AutoDock Vina 1.1.2.}
\end{table}

\section{Benchmark of Virtual Screening}

We collected 12 receptors from the PDB database \citep{540}, 1000 ligands with a molecular weight of 200-300g/mol, 1000 ligands with a molecular weight of 300-400g/mol, and 1000 ligands with a molecular weight of 400-500g/mol from the ZINC database \citep{1178}. The 3000 ligands were docked against the 12 receptors by Vina and idock. Table \ref{tab:ExecutionTime} compares their CPU time and elapsed time. Conclusively idock outperformed Vina by at least 8.69 times and at most 37.51 times.

\begin{table}
\processtable{CPU time and elapsed time in hours of docking 3000 clean ligands of 3 molecular weight sets against 12 receptors by Vina and idock. The GNU Time utility v1.7 was used as profiler.\label{tab:ExecutionTime}}
{\begin{tabular}{crrrrrr}
\toprule
& \multicolumn{2}{c}{200-300g/mol} & \multicolumn{2}{c}{300-400g/mol} & \multicolumn{2}{c}{400-500g/mol}\\
& CPU & Elapsed & CPU & Elapsed & CPU & Elapsed\\
\midrule
\multicolumn{7}{l}{\textbf{1HCL} human cyclin-dependent kinase 2}\\
Vina  & 12.57 &  3.33 & 22.55 &  5.91 & 51.62 & 13.41\\
idock &  0.63 &  0.16 &  0.92 &  0.24 &  1.38 &  0.36\\
Ratio & 20.06 & 20.25 & 24.41 & 24.39 & 37.51 & 36.81\\
\multicolumn{7}{l}{\textbf{1J1B} human tau protein kinase I}\\
Vina  &  9.07 &  2.47 & 14.69 &  3.92 & 32.28 &  8.49\\
idock &  0.78 &  0.21 &  1.25 &  0.33 &  2.35 &  0.62\\
Ratio & 11.55 & 11.92 & 11.73 & 11.87 & 13.73 & 13.73\\
\multicolumn{7}{l}{\textbf{1LI4} human S-adenosylhomocysteine hydrolase}\\
Vina  & 11.82 &  3.30 & 19.08 &  5.22 & 39.41 & 10.64\\
idock &  0.89 &  0.23 &  1.55 &  0.40 &  3.15 &  0.82\\
Ratio & 13.24 & 14.14 & 12.33 & 12.95 & 12.50 & 12.98\\
\multicolumn{7}{l}{\textbf{1V9U} human rhinovirus 2 coat protein VP1}\\
Vina  &  9.80 &  2.95 & 15.55 &  4.62 & 29.75 &  8.49\\
idock &  0.97 &  0.25 &  1.64 &  0.42 &  3.42 &  0.89\\
Ratio & 10.11 & 11.74 &  9.49 & 10.91 &  8.69 &  9.56\\
\multicolumn{7}{l}{\textbf{2IQH} influenza A virus nucleoprotein NP}\\
Vina  &  9.51 &  2.66 & 15.03 &  4.08 & 29.64 &  7.83\\
idock &  0.92 &  0.24 &  1.59 &  0.41 &  3.41 &  0.88\\
Ratio & 10.35 & 11.18 &  9.43 &  9.93 &  8.69 &  8.93\\
\multicolumn{7}{l}{\textbf{2XSK} Escherichia coli curli protein CsgC - SeCys}\\
Vina  & 10.44 &  2.71 & 17.89 &  4.61 & 40.58 & 10.41\\
idock &  0.71 &  0.19 &  1.16 &  0.30 &  2.16 &  0.56\\
Ratio & 14.68 & 14.64 & 15.47 & 15.38 & 18.83 & 18.57\\
\multicolumn{7}{l}{\textbf{2ZD1} HIV-1 reverse transcriptase}\\
Vina  &  9.78 &  2.70 & 17.67 &  4.76 & 42.03 & 11.33\\
idock &  0.97 &  0.25 &  1.52 &  0.39 &  2.60 &  0.69\\
Ratio & 10.05 & 10.73 & 11.61 & 12.07 & 16.14 & 16.54\\
\multicolumn{7}{l}{\textbf{2ZNL} influenza virus RNA polymerase subunit PA}\\
Vina  &  9.49 &  2.60 & 15.04 &  4.01 & 29.97 &  7.82\\
idock &  0.89 &  0.23 &  1.56 &  0.40 &  3.41 &  0.87\\
Ratio & 10.70 & 11.37 &  9.65 & 10.06 &  8.78 &  8.98\\
\multicolumn{7}{l}{\textbf{3BGS} human purine nucleoside phosphorylase}\\
Vina  &  9.59 &  2.57 & 16.50 &  4.37 & 38.42 & 10.14\\
idock &  0.95 &  0.25 &  1.55 &  0.40 &  2.81 &  0.74\\
Ratio & 10.09 & 10.45 & 10.65 & 10.89 & 13.65 & 13.75\\
\multicolumn{7}{l}{\textbf{3H0W} human S-adenosylmethionine decarboxylase}\\
Vina  &  9.85 &  2.64 & 17.67 &  4.70 & 41.69 & 11.04\\
idock &  0.88 &  0.23 &  1.35 &  0.35 &  2.20 &  0.58\\
Ratio & 11.17 & 11.50 & 13.07 & 13.28 & 18.99 & 19.11\\
\multicolumn{7}{l}{\textbf{3IAR} human adenosine deaminase}\\
Vina  & 11.25 &  3.03 & 20.21 &  5.39 & 46.93 & 12.53\\
idock &  0.80 &  0.21 &  1.21 &  0.32 &  2.01 &  0.53\\
Ratio & 14.10 & 14.44 & 16.68 & 16.90 & 23.34 & 23.59\\
\multicolumn{7}{l}{\textbf{3KFN} HIV protease}\\
Vina  & 10.53 &  2.80 & 18.37 &  4.83 & 42.43 & 11.03\\
idock &  0.77 &  0.20 &  1.20 &  0.32 &  2.09 &  0.55\\
Ratio & 13.69 & 13.85 & 15.29 & 15.32 & 20.32 & 20.12\\
\multicolumn{7}{l}{\textbf{Average across the above 12 receptors}}\\
Vina  & 10.31 &  2.81 & 17.52 &  4.70 & 38.73 & 10.26\\
idock &  0.85 &  0.22 &  1.38 &  0.36 &  2.58 &  0.67\\
Ratio & 12.48 & 13.02 & 13.32 & 13.66 & 16.76 & 16.89\\
\botrule
\end{tabular}}{idock 1.5 outperformed AutoDock Vina 1.1.2 in terms of docking speed by at least 8.69 times and at most 37.51 times.}
\end{table}

\bibliographystyle{natbib}
\bibliography{document}

\end{document}
