\documentclass{bioinfo}
\copyrightyear{2012}
\pubyear{2012}

\begin{document}
\firstpage{1}

\title[idock and istar]{idock: Improving Docking Speed over AutoDock Vina and istar: Software-as-a-Service Platform for idock}
\author[Hongjian Li \textit{et~al}]{Hongjian Li\footnote{to whom correspondence should be addressed}, Kwong-Sak Leung and Man-Hon Wong}
\address{Department of Computer Science and Engineering, Chinese University of Hong Kong, Shatin, New Territories, Hong Kong, China}

\history{Received on XXXXX; revised on XXXXX; accepted on XXXXX}

\editor{Associate Editor: XXXXXXX}

\maketitle

\begin{abstract}
\section{Summary:}
In a previous study, we reported idock 1.0, a multithreaded virtual screening tool for flexible ligand docking. In this study, we report idock 1.6, further improving docking speed and accuracy, inventing new functionalities, and fixing bugs. To better evaluate and compare idock 1.6 with the state-of-the-art AutoDock Vina 1.1.2, we have carried out a redocking benchmark on PDBbind v2011 and CSAR NRC HiQ Set 24Sept2010, and a virtual screening benchmark on 12 receptors and 3000 ligands. The results have shown that under various circumstances idock 1.6 displayed comparable success rates but outperformed AutoDock Vina in terms of docking speed by at least 8.69 times and at most 37.51 times. Furthermore, we were motivated by the desire to automate large-scale protein-ligand docking using our idock and thus have developed istar, a general SaaS (Software as a Service) platform. Without any tedious software installation, users, especially computational chemists, can submit jobs on the fly either by browsing our web site or by programming against our RESTful API. Our HTML5- and CSS3-powered web site supports filtering and previewing ligands to dock, as well as monitoring job progress in real time, two very useful features commonly lacked in other SaaS platforms like DOCK Blaster. We have developed a customized daemon from idock 1.6 and implemented two-phase docking. We have deployed several high-performance workstations to run the idock daemon in the background and exploited fine-grained slice-level parallelism in phase 1. The daemon compresses result files using gzip to save server storage and network bandwidth. We have tested our web site with Chrome 19+, Firefox 12+, IE 9+, Safari 5+ and Opera 12+. We have also recorded a video tutorial for newbies to get started easily.
\section{Availability:}
Both idock and istar are free and open source under Apache License 2.0. For idock, its C++ source code, precompiled executables for 32-bit and 64-bit Linux, Windows, Mac OS X, FreeBSD and Solaris, 13 docking examples, and a doxygen file for generating API documentations are available at https://github.com/HongjianLi/idock. For istar, its C++ and JavaScript source code is available at https://github.com/HongjianLi/istar. A live demo is running at http://istar.cse.cuhk.edu.hk.
\section{Contact:} \href{hjli@cse.cuhk.edu.hk}{hjli@cse.cuhk.edu.hk}
\section{Supplementary Information:} Supplementary data and evaluation results are available at \textit{Bioinformatics} online.
\end{abstract}

\section{Introduction}

Protein-ligand docking predicts the preferred conformation and binding affinity of a small ligand when it is non-covalently bound to a specific binding site of a macro protein. Inspired by AutoDock Vina \citep{595}, we have developed idock 1.0 \citep{1153}, a multithreaded virtual screening tool for flexible ligand docking. idock inherits from AutoDock Vina the accurate scoring function and the efficient optimization algorithm, and meanwhile introduces a list of fruitful innovations, such as receptor and grid map caching for large-scale virtual screening, revised numerical model for much faster approximation, capability of automatic detection and deactivation of inactive torsions, utilization of our novel thread pool to parallelize grid map creation and reuse threads, utilization of modern C++11 features like right-value references to avoid frequent memory reallocation, and accelerated parsers for both receptor and ligand. When benchmarked on docking 10,928 drug-like ligands against HIV-1 reverse transcriptase, idock 1.0 achieved a speedup of 3.3 in terms of CPU time and a speedup of 7.5 in terms of elapsed time on average compared to AutoDock Vina.

Despite the amazing speedup, idock 1.0 required about 10 hours to dock 10,928 drug-like ligands, not to mention massive docking of millions of ligands. Faster implementations are highly desired. Here we report idock 1.6, further improving docking speed and accuracy, inventing new functionalities, and fixing bugs. Moreover, in order to automate large-scale protein-ligand docking and use our idock online, we have developed istar, a general SaaS platform.

\begin{methods}
\section{Change Log}

Computationally speaking, idock 1.6 better supports right-value references and move semantics in C++11 to boost performance. It implements our novel thread pool in order to reuse threads and maintain a high CPU utilization throughout the entire screening procedure. The thread pool parallelizes the precalculation of scoring function, the creation of grid maps, and the execution of Monte Carlo tasks. idock 1.6 implements our own lightweight thread-safe progress bar, reporting progress every 10\% Monte Carlo tasks per ligand in a neat manner. It provides precompiled executables for 5 mainstream operating systems and 13 docking examples for instance use.

Functionally speaking, idock 1.6 supports reading and writing ligands in gzip/bzip2 format, resulting in a file footprint as low as just one eighth of the raw size. It supports as many as 29 chemical elements including rare ones like As (arsenic) and Sr (strontium). idock 1.6 enables automatic recovery, i.e. in case the process gets killed accidentally and restarted some time later, it not only resumes docking from the previous stopping point, but also detects and reports possible file content errors. It outputs to docked PDBQT files verbose information including putative inter-molecular hydrogen bonds and per-atom inter-molecular free energy, facilitating protein-ligand interaction hotspot detection and subsequent analysis.

Refer to the idock web site for a full list of enhancements and bugfixes.

\end{methods}

\section{Benchmark of Redocking}

Redocking refers to randomizing the crystal ligand conformation in a protein-ligand complex and trying to dock the randomized conformation back to its crystal conformation as close as possible. Sometimes it is referred to as pose fidelity. We used two datasets of protein-ligand complexes for redocking benchmark. The refined set of PDBbind v2011 \citep{530} and the two sets of CSAR NRC HiQ Set 24Sept2010 \citep{857} comprise 2,455 and 343 protein-ligand complexes respectively. idock x86\_64 1.6 and AutoDock Vina x86 v1.1.2 were evaluated on desktop computers with Intel Core i5-2400 CPU @ 3.10GHz and 4GB DDR3 SDRAM under Mac OS X 10.7.4 Build 11E53.

Supplementary table 1 shows the redocking success rates of idock and AutoDock Vina under various conditions regarding the RMSD (Root Mean Square Deviation) values between the crystal and docked conformations. It can be seen that the success rates of idock were comparable to, albeit slightly lower than, AutoDock Vina. Using a RMSD value of 2.0 \AA, both programs managed to predict a conformation close enough to the crystal conformation as the first conformation for over half of the cases on both datasets.

\section{Benchmark of Virtual Screening}

We collected 12 diverse receptors from the PDB database \citep{540}, 1000 ligands with a molecular weight of 200-300g/mol, 1000 ligands with a molecular weight of 300-400g/mol, and 1000 ligands with a molecular weight of 400-500g/mol from the ZINC database \citep{1178}. The 3000 ligands were docked against the 12 receptors by Vina and idock. Supplementary table 2 compares their CPU time and elapsed time. Conclusively idock outperformed Vina by at least 8.69 times and at most 37.51 times.

\section{idock on istar}

We have developed a general SaaS platform called istar, and hosted idock by istar for automatic large-scale protein-ligand docking. Under typical circumstance, a user browses our web site and submits a job. Our web server first validates and sanitizes user input and then saves it into a database. Several workstations run daemons in the background, fetching jobs from the database and carrying out experiments. Upon completion, they send a notification email to the user and write the result to the network file system, which is served and cached as static content. The user again browses our web site to download result. Refer to the istar web site for a complete workflow.

On the client side, we have seamlessly combined both the Twitter Bootstrap and the HTML5 Boilerplate into a HTML5- and CSS3-powered web site (Supplementary figure 1). Our idock web page supports filtering and previewing ligands to dock, as well as monitoring job progress in real time, two very useful and unique features only available at istar. We have exposed job submission, job query, and ligand counting as RESTful API (Supplementary figure 2). We have also recorded a video tutorial for newbies to get started.

On the network file system side, we have collected 12,171,187 clean ligands from the ZINC database \citep{532,1178} with conditional permission from its developer.

On the workstation side, we have developed a customized daemon of idock 1.6 in modern C++11, adding necessary code to iteratively fetch a pending job from the database, reuse receptor and grid maps whenever possible, perform 2-phase docking, report progress, compress results, and send email notification upon job completion.

Our idock daemon features 2-phase docking. In phase 1, idock performs coarse but fast docking without writing any conformations, aiming to quickly shortlist a few thousand candidates. In phase 2, idock performs fine but slow docking for the candidates with a significantly larger number of Monte Carlo tasks, writing as many conformations as possible. Such a 2-phase docking methodology can remarkably reduce job execution time while avoiding the risk of filtering out potentially promising compounds.

Our idock daemon features slice-level parallelism rather than job-level parallelism. We have managed to split a job into slices and distribute them to idle workstations in phase 1 for parallel docking.

DOCK Blaster \citep{557} was created to investigate the feasibility of full automation of large-scale protein-ligand docking. Here we highlight the advantages of istar over DOCK Blaster. istar is free and open source under Apache License 2.0. Everyone is welcome to download a copy and deploy istar to his/her own servers. istar is designed as a general SaaS platform. It can host not only idock but also any other programs on the same web site. istar utilizes the state-of-the-art technologies and supports filtering and previewing ligands to dock, as well as monitoring job progress in real time. istar implements 2-phase docking and exploits fine-grained slice-level parallelism in phase 1.

\section*{Acknowledgement}

We thank Professor John J. Irwin for granting us permission to use ZINC with three conditions as stated at the istar web site.

\bibliographystyle{natbib}
\bibliography{document}

\end{document}
